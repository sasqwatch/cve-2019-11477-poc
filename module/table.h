#ifndef __TABLE_H__
#define __TABLE_H__

#include <linux/slab.h>
#include <linux/list.h>
#include "../../include/connection_info.h"

#define INIT_TABLE(table) \
  static struct elem table = { \
    .saddr = 0, .sport = 0, .daddr = 0, .dport = 0, .caddr = 0, .cport = 0 }

struct elem
{
  uint32_t saddr;
  uint16_t sport;
  uint32_t daddr;
  uint16_t dport;
  uint32_t caddr;
  uint32_t cport;
  struct list_head list;
};

int init_elem(struct elem *e, struct connection_info_st *conn_info);
int register_elem_to_table(struct elem *e, struct elem *table);
struct elem *find_elem_from_table(struct connection_info_st *conn_info,
    struct elem *table);
void delete_elem_from_table(struct connection_info_st *conn_info, struct elem *table);

#endif /* __TABLE_H__ */
