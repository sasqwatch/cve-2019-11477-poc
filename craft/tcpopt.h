#ifndef __TCPOPT_H__
#define __TCPOPT_H__

#include <stdio.h>
#include <string.h>
#include <stdint.h>
#include <linux/tcp.h>
#include "../include/debug.h"
#include "../include/defines.h"

#define TCPOPT_NO_OPERATION   0x1
#define TCPOPT_MSS            0x2
#define TCPOPT_WINDOW_SCALE   0x3
#define TCPOPT_SACK_PERMITTED 0x4
#define TCPOPT_SACK           0x5

struct tcpopt_st
{
  uint8_t type;
  uint8_t length;
  uint64_t val;
  struct tcpopt_st *next;
};

struct tcpopt_st *get_tcpopt_blocks(struct tcphdr *tcph);
void free_tcpopt_blocks(struct tcpopt_st *blks);

struct tcpopt_st *init_tcpopt_block(void);
void free_tcpopt_block(struct tcpopt_st *blk);

int modify_tcpopt_block(struct tcpopt_st *tcph, int type, int val); 
void print_tcpopt_blocks(struct tcpopt_st *tcph);

int serialize_tcphdr(struct tcphdr *tcph, struct tcpopt_st *blks);

#endif /* __TCPOPT_H__ */
